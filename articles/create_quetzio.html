<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="shiny.quetzio">
<title>Create a questionnaire • shiny.quetzio</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a questionnaire">
<meta property="og:description" content="shiny.quetzio">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">shiny.quetzio</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/create_quetzio.html">Create a questionnaire</a>
    <a class="dropdown-item" href="../articles/update_quetzio.html">Update created questionnaire</a>
    <a class="dropdown-item" href="../articles/link_quetzio.html">Link multiple questionnaires together</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="create_quetzio_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Create a questionnaire</h1>
            
      
      
      <div class="d-none name"><code>create_quetzio.Rmd</code></div>
    </div>

    
    
<p>Package <strong>shiny.quetzio</strong> provides a relatively simple but also highly customizable framework for creation and deploying questionnaire as a part of your <em>shinyApp</em>.</p>
<p>Every questionnaire created in this framework takes a form of object of class <strong>quetzio_server</strong>, and needs to be called inside the <em>server</em> of your application.</p>
<p>This vignette is going to take you on all basic things you should know about using this package to include a questionnaire within your application - how to build your configuration file, what are the core possibilities of <strong>quetzio_server</strong> both as an semi-independent object and as a part of more complex logic in your application.</p>
<div class="section level2">
<h2 id="what-is-the-quetzio_server">What is the <strong>quetzio_server</strong>?<a class="anchor" aria-label="anchor" href="#what-is-the-quetzio_server"></a>
</h2>
<p>It is main element of the whole functionality of <strong>shiny.quetzio</strong>. Its the <em>R6</em> class definition used to create objects creating Shiny modules upon initialization. It takes a source of the questions (and optionally: additional instruction and descriptions for individual inputs) and generates the whole questionnaire UI. Within the created module the entire backend for the reactivity is contained (consisting of answers validation and their output).</p>
<p>Generally, the basic dataflow within this process is shown in figure below.</p>
<div class="figure">
<img src="quetzio_server_logic.png" alt="Logic of quetzio_server object" width="600px"><p class="caption">
Logic of quetzio_server object
</p>
</div>
</div>
<div class="section level2">
<h2 id="what-is-the-structure-of-question-source">What is the structure of question source?<a class="anchor" aria-label="anchor" href="#what-is-the-structure-of-question-source"></a>
</h2>
<p>As seen on the figure above, there are three possible sources for the questions:</p>
<ul>
<li>googlesheets (needs <strong>googlesheets4</strong> package installed)</li>
<li>yaml (needs <strong>yaml</strong> package installed)</li>
<li>R object (<em>list</em> or <em>data.frame</em>)</li>
</ul>
<p>Only one source method can be used. It needs to be defined during initialization by specifying <code>source_method</code> argument in the call of <code>quetzio_server$new()</code></p>
<p>In the source, for every <em>shinyInput</em> you can specify following parameters:</p>
<ul>
<li><strong>inputId</strong></li>
<li><strong>type</strong></li>
<li><strong>label</strong></li>
<li>mandatory: (true/false) if the input must be filled</li>
<li>width: the same as in regular input specification. If not provided, defaults to 500px</li>
</ul>
<blockquote>
<p><strong>Bold</strong> ones are mandatory!</p>
</blockquote>
<p>Additionally, various supported shinyInput types support additional parameters. Table of the supported shinyInputs with all possible parameters is provided below:</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="16%">
<col width="16%">
<col width="16%">
<col width="16%">
<col width="16%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th align="center">parameter</th>
<th align="center">textInput</th>
<th align="center">numericInput</th>
<th align="center">selectizeInput</th>
<th align="center">radioButtons</th>
<th align="center">likertRadioButtons</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">placeholder</td>
<td align="center">x</td>
<td align="center">x</td>
<td align="center">x</td>
<td align="center"></td>
<td align="center">x</td>
</tr>
<tr class="even">
<td align="center">regex</td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">value</td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">min</td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">max</td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">step</td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">choices</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"><strong>x</strong></td>
<td align="center"><strong>x</strong></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">choiceValues</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"><strong>x</strong></td>
<td align="center"><strong>x</strong></td>
<td align="center"><strong>x</strong></td>
</tr>
<tr class="odd">
<td align="center">choiceNames</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"><strong>x</strong></td>
<td align="center"><strong>x</strong></td>
<td align="center"><strong>x</strong></td>
</tr>
<tr class="even">
<td align="center">maxItems</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">create</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">maxOptions</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">selected</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center">x</td>
<td align="center">x</td>
</tr>
<tr class="even">
<td align="center">inline</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
</tr>
</tbody>
</table>
<blockquote>
<p>Parameters with bolded <strong>x</strong> are mandatory. You can specify either <em>choices</em> or both <em>choiceValues</em> and <em>choiceNames</em> for <code>selectizeInput</code> and <code>radioButtons</code>.</p>
</blockquote>
<div class="section level3">
<h3 id="yaml-source-method-source_method-yaml">YAML source method (<code>source_method == 'yaml'</code>)<a class="anchor" aria-label="anchor" href="#yaml-source-method-source_method-yaml"></a>
</h3>
<p>The main intended way of sourcing data for the module is by creating a <em>YAML</em> source file in a very simple form - template shown below. It also requires installation of the <em>yaml</em> R package</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">inputId_1</span><span class="kw">:</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="at">   </span><span class="fu">type</span><span class="kw">:</span><span class="at"> shinyInput_type</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="at">   </span><span class="fu">label</span><span class="kw">:</span><span class="at"> shinyInput_label</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="at">   </span><span class="fu">parameter_1</span><span class="kw">:</span><span class="at"> value</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="at">   </span><span class="fu">parameter_2</span><span class="kw">:</span><span class="at"> value</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="at">   </span><span class="fu">parameter_n</span><span class="kw">:</span><span class="at"> value</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">inputId_2</span><span class="kw">:</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="at">   </span><span class="fu">type</span><span class="kw">:</span><span class="at"> shinyInput_type</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="at">   </span><span class="fu">label</span><span class="kw">:</span><span class="at"> shinyInput_label</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="at">   </span><span class="fu">parameter</span><span class="kw">:</span><span class="at"> value</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="at">   </span><span class="fu">multi-value_parameter</span><span class="kw">:</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="at">     </span><span class="kw">-</span><span class="at"> value_1</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="at">     </span><span class="kw">-</span><span class="at"> value_2</span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="at">     </span><span class="kw">-</span><span class="at"> value_n</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="fu">inputId_n</span><span class="kw">:</span><span class="at"> ...</span></span></code></pre></div>
<blockquote>
<p>inputId don’t need to be specified as a parameter, but need to be provided as the name of the sequence</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="googlesheets-source-method-source_method-gsheet">googlesheets source method (<code>source_method == 'gsheet'</code>)<a class="anchor" aria-label="anchor" href="#googlesheets-source-method-source_method-gsheet"></a>
</h3>
<p>Additional way of sourcing data, especially useful if you intend to frequently update the questions or there will be multiple people collaborating during the run of the Shiny application.</p>
<p>To use this method the <em>googlesheets4</em> R package needs to be installed.</p>
<p>You can create example googlesheet using helper function provided with the package. It makes sure that all needed columns are present and they are containing correct classes.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># assignement to hold the ID of created googlesheet</span>
<span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_quetzio_source.html">create_quetzio_source</a></span><span class="op">(</span>
  method <span class="op">=</span> <span class="st">"gsheet"</span><span class="op">)</span>

<span class="co"># see the data structure:</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span>
  <span class="fu">googlesheets4</span><span class="fu">::</span><span class="fu"><a href="https://googlesheets4.tidyverse.org/reference/range_read.html" class="external-link">read_sheet</a></span><span class="op">(</span>ss <span class="op">=</span> <span class="va">id</span>, sheet <span class="op">=</span> <span class="st">"Questions"</span><span class="op">)</span>
  <span class="op">)</span>
<span class="co">#&gt; tibble [1 × 18] (S3: tbl_df/tbl/data.frame)</span>
<span class="co">#&gt;  $ inputId          : chr "placeholder"</span>
<span class="co">#&gt;  $ type             : chr "textInput"</span>
<span class="co">#&gt;  $ mandatory        : logi TRUE</span>
<span class="co">#&gt;  $ label            : chr "Remove before production"</span>
<span class="co">#&gt;  $ width            : chr "500px"</span>
<span class="co">#&gt;  $ placeholder      : chr "some text"</span>
<span class="co">#&gt;  $ chr_regex        : chr "^pattern$"</span>
<span class="co">#&gt;  $ num_value        : num 1</span>
<span class="co">#&gt;  $ num_min          : num 0</span>
<span class="co">#&gt;  $ num_max          : num 2</span>
<span class="co">#&gt;  $ num_step         : num 0.5</span>
<span class="co">#&gt;  $ mult_choices     : chr "Something\nElse\nMore"</span>
<span class="co">#&gt;  $ mult_choiceValues: chr "1\n2\n3"</span>
<span class="co">#&gt;  $ mult_choiceNames : chr "One\nTwo\nThree"</span>
<span class="co">#&gt;  $ mult_selected    : logi NA</span>
<span class="co">#&gt;  $ select_maxItems  : num 1</span>
<span class="co">#&gt;  $ select_create    : logi TRUE</span>
<span class="co">#&gt;  $ radio_inline     : logi TRUE</span>

<span class="co"># I remove the googlesheet created for this presentation</span>
<span class="fu">googledrive</span><span class="fu">::</span><span class="fu"><a href="https://googledrive.tidyverse.org/reference/drive_trash.html" class="external-link">drive_trash</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></code></pre></div>
<p>As you can see, it contains one placeholder row with exemplary values and correct types. You can populate the <em>googlesheet</em> using Google Drive GUI - remember to remove the placeholder row!</p>
<blockquote>
<p>Values of multi-values parameters need to be separated within one cell with either a semicolon or newline</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="providing-r-object-as-a-source-source_method-raw">providing R object as a source (<code>source_method == 'raw'</code>)<a class="anchor" aria-label="anchor" href="#providing-r-object-as-a-source-source_method-raw"></a>
</h3>
<p>If, for any reason you can’t or won’t install <em>yaml</em> or <em>googlesheets4</em> packages or just prefer assigning the created R object as a source, you can provide either a list or data.frame during initialization of new <em>quetzio_server</em> object.</p>
<p>They are analogous to the structure of <em>yaml</em> (list) or <em>googlesheet</em> (data.frame) source file. You can check the correct structure for the same two-item example questionnaire configured in both list and data.frame below.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># every nested list need to be named with the inputId</span>
<span class="va">list_source</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  textItem <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    type <span class="op">=</span> <span class="st">"textInput"</span>,
    label <span class="op">=</span> <span class="st">"First input"</span>,
    placeholder <span class="op">=</span> <span class="st">"Write inside of me, please!"</span><span class="op">)</span>,
  selectizeItem <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    type <span class="op">=</span> <span class="st">"selectizeInput"</span>,
    label <span class="op">=</span> <span class="st">"Choose up to two"</span>,
    choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"I am first"</span>, <span class="st">"I am second"</span>, <span class="st">"I am third"</span>, <span class="st">"Who am I?"</span><span class="op">)</span>,
    maxItems <span class="op">=</span> <span class="fl">2</span>,
    mandatory <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="co"># data.frame can be configured explicitly by 'data.frame'</span>
<span class="va">df_source</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>
  inputId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"textItem"</span>, <span class="st">"selectizeItem"</span><span class="op">)</span>,
  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"textInput"</span>, <span class="st">"selectizeInput"</span><span class="op">)</span>,
  mandatory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">TRUE</span><span class="op">)</span>,
  label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"First input"</span>, <span class="st">"Choose up to two"</span><span class="op">)</span>,
  placeholder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Write inside of me, please!"</span>, <span class="cn">NA</span><span class="op">)</span>,
  mult_choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"I am first;I am second;I am third;Who am I?"</span><span class="op">)</span>,
  select_maxItems <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">2</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># You can also use the same function as for googlesheet generation to generate</span>
<span class="co"># example data.frame with placeholder row, though you need to modify it</span>
<span class="co"># afterwards</span>

<span class="va">df_source2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_quetzio_source.html">create_quetzio_source</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"df"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">df_source2</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    1 obs. of  18 variables:</span>
<span class="co">#&gt;  $ inputId          : chr "placeholder"</span>
<span class="co">#&gt;  $ type             : chr "textInput"</span>
<span class="co">#&gt;  $ mandatory        : logi TRUE</span>
<span class="co">#&gt;  $ label            : chr "Remove before production"</span>
<span class="co">#&gt;  $ width            : chr "500px"</span>
<span class="co">#&gt;  $ placeholder      : chr "some text"</span>
<span class="co">#&gt;  $ chr_regex        : chr "^pattern$"</span>
<span class="co">#&gt;  $ num_value        : num 1</span>
<span class="co">#&gt;  $ num_min          : num 0</span>
<span class="co">#&gt;  $ num_max          : num 2</span>
<span class="co">#&gt;  $ num_step         : num 0.5</span>
<span class="co">#&gt;  $ mult_choices     : chr "Something\nElse\nMore"</span>
<span class="co">#&gt;  $ mult_choiceValues: chr "1\n2\n3"</span>
<span class="co">#&gt;  $ mult_choiceNames : chr "One\nTwo\nThree"</span>
<span class="co">#&gt;  $ mult_selected    : chr NA</span>
<span class="co">#&gt;  $ select_maxItems  : num 1</span>
<span class="co">#&gt;  $ select_create    : logi TRUE</span>
<span class="co">#&gt;  $ radio_inline     : logi TRUE</span></code></pre></div>
<blockquote>
<p>The list is recommended for source, though with long questionnaires and similiar shinyInput types the data.frame source can be easier to generate - it all depends on your workflow and the structure of the questionnaire</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="embedding-the-questionnaire-in-your-shinyapp">Embedding the questionnaire in your shinyApp<a class="anchor" aria-label="anchor" href="#embedding-the-questionnaire-in-your-shinyapp"></a>
</h2>
<p>If you have your source created correctly, it is the time to embed the questionnaire in your Shiny application. You need to make some calls both in the <em>server</em> and in the <em>ui</em> parts of your application.</p>
<div class="section level3">
<h3 id="generation-of-the-quetzio_server-object">Generation of the quetzio_server object<a class="anchor" aria-label="anchor" href="#generation-of-the-quetzio_server-object"></a>
</h3>
<p>You need to create the <strong>quetzio_server</strong> object inside of your <em>server</em> code. There are following mandatory arguments for the <code>quetzio_server$new()</code></p>
<ul>
<li>source_method: to choose the source method (‘yaml’, ‘gsheet’, ‘raw’)
<ul>
<li>for <code>source_method == 'yaml'</code>: <strong>source_yaml</strong>
</li>
<li>for <code>source_method == 'gsheet'</code>: <strong>source_gsheet_id</strong> and <strong>source_gsheet_sheetname</strong>
</li>
<li>for <code>source_method == 'raw'</code>: <strong>source_object</strong>
</li>
</ul>
</li>
<li>module_id: character string to reference created module</li>
</ul>
<p>So to create the questionnaire based on the source created above:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">quetzio_from_list</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/quetzio_server.html">quetzio_server</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  source_method <span class="op">=</span> <span class="st">"raw"</span>,
  source_object <span class="op">=</span> <span class="va">list_source</span>,
  module_id <span class="op">=</span> <span class="st">"my_questionnaire"</span>
<span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="adding-the-questionnaire-to-you-ui">Adding the questionnaire to you UI<a class="anchor" aria-label="anchor" href="#adding-the-questionnaire-to-you-ui"></a>
</h3>
<p>The questionnaire isn’t seen anywhere in the UI yet! You can show it by adding in your UI the following call:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/quetzio_UI.html">quetzio_UI</a></span><span class="op">(</span>module_id <span class="op">=</span> <span class="st">"my_questionnaire"</span><span class="op">)</span></code></pre></div>
<p>Yes - this is all!</p>
<blockquote>
<p>Remember that all shiny modules IDs needs to be unique withing your application environement!</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="using-the-built-in-googlesheets-output-method">Using the built-in googlesheets output method<a class="anchor" aria-label="anchor" href="#using-the-built-in-googlesheets-output-method"></a>
</h3>
<p>If you wish to send the results of the survey automatically to some <em>googlesheet</em> file, you can specify additional arguments in the <strong>quetzio_server$new()</strong>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># the same questionnaire as above</span>
<span class="va"><a href="../reference/quetzio_server.html">quetzio_server</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  source_method <span class="op">=</span> <span class="st">"raw"</span>,
  source_object <span class="op">=</span> <span class="va">list_source</span>,
  module_id <span class="op">=</span> <span class="st">"my_questionnaire"</span>,
  <span class="co"># but with specific arguments for the googlesheet output</span>
  output_gsheet <span class="op">=</span> <span class="cn">TRUE</span>,
  output_gsheet_id <span class="op">=</span> <span class="st">"your_googlesheet_id"</span>,
  output_gsheet_sheetname <span class="op">=</span> <span class="st">"sheet_name"</span>
<span class="op">)</span></code></pre></div>
<blockquote>
<p>As you can see above, the assignement of the object isn’t necessary. It don’t allow for reading the state of the questionnaire or getting the asnwers in the application. In the example above, the answers will be saved in the external <em>googlesheet</em>, so the answer reading won’t be necessary.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="reading-the-state-of-the-created-quetzio_server-object-within-the-application-">Reading the state of the created quetzio_server object within the application.<a class="anchor" aria-label="anchor" href="#reading-the-state-of-the-created-quetzio_server-object-within-the-application-"></a>
</h3>
<p>You can get some information from your questionnaire by calling the following calls on your object:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># All of the above are 'reactiveVal' object, so they need to be </span>
<span class="co"># accessed in the observe() or reactive() context</span>
<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observe.html" class="external-link">observe</a></span><span class="op">(</span><span class="op">{</span>
  
  <span class="co"># is the questionnaire done: TRUE or FALSE</span>
  <span class="va">my_questionnaire</span><span class="op">$</span><span class="fu">is_done</span><span class="op">(</span><span class="op">)</span>

  <span class="co"># check if there are any warning messages: if none, then NULL</span>
  <span class="va">my_questionnaire</span><span class="op">$</span><span class="fu">message</span><span class="op">(</span><span class="op">)</span>

  <span class="co"># get the list of answers. If questionnaire isn't done, then NULL</span>
  <span class="va">my_questionnaire</span><span class="op">$</span><span class="fu">answers</span><span class="op">(</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="adding-instructions-andor-item-descriptions-optional">Adding instructions and/or item descriptions (optional)<a class="anchor" aria-label="anchor" href="#adding-instructions-andor-item-descriptions-optional"></a>
</h2>
<p>One of the optional features of the <strong>quetzio_server</strong> is the ability to generate multi-paragraph instructions and item descriptions for you questionnaire.</p>
<p>For elements of instruction and/or item description you need to provide correct config, describing following element <em>types</em>:</p>
<ul>
<li>for instruction
<ul>
<li>
<strong>instruction_title</strong>: generates <em>h1</em> tag of class <strong>quetzio_title</strong>
</li>
<li>
<strong>instruction_para</strong>: generates <em>p</em> tag of class <strong>quetzio_paragraph</strong>
</li>
<li>
<strong>instruction_list</strong>: generates <em>ul</em> or <em>ol</em> tag of class <strong>quetzio_list</strong>
</li>
<li>all elements are pasted together in the given order within <em>div</em> of css class <strong>quetzio_instruction</strong>. It will be located just before the first question.</li>
</ul>
</li>
<li>for descriptions
<ul>
<li>
<strong>item_desc</strong>: generates item description, which will appear between item label and input</li>
<li>it will be contained within <em>div</em> of css class <strong>quetzio_description</strong>
</li>
</ul>
</li>
</ul>
<p>Following parameters can be provided to these element (with some mandatory!):</p>
<ul>
<li>
<em>content</em>: the whole content of the given element
<ul>
<li><strong>mandatory</strong></li>
<li>for every element type</li>
</ul>
</li>
<li>
<em>align</em>: how the <em>content</em> should be aligned withing its container
<ul>
<li>optional: if not specified, the default is ‘left’</li>
<li>for every element type</li>
</ul>
</li>
<li>
<em>html</em>: are there any HTML tags specified in the <em>text</em>
<ul>
<li>optional: if not specified, the default is FALSE</li>
<li>for every element type but <em>instruction_list</em>
</li>
</ul>
</li>
<li>
<em>order</em>: should the list be ordered
<ul>
<li>optional: if not specified, the default is FALSE</li>
<li>for <em>instruction_list</em> only</li>
</ul>
</li>
<li>
<em>inputId</em>: for which inputId it should be generated
<ul>
<li>
<strong>mandatory</strong>, but only for <em>item_desc</em>
</li>
</ul>
</li>
</ul>
<div class="section level3">
<h3 id="yaml-source">YAML source<a class="anchor" aria-label="anchor" href="#yaml-source"></a>
</h3>
<p>Needs the <em>yaml</em> R package to be installed, and should be passed to <em>desc_yaml</em> argument during initialization of <em>quetzio_server</em> object.</p>
<p>Its form is similiar to the one of the YAML question source, but the sequences don’t need to be named:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">-</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> some_element_type</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="at">  </span><span class="fu">content</span><span class="kw">:</span><span class="at"> content_of_element</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="at">  </span><span class="fu">additional_parameter</span><span class="kw">:</span><span class="at"> value</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="kw">-</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> type_of_second_element</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="at">  </span><span class="fu">content</span><span class="kw">:</span><span class="at"> content_of_second</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="at">  </span><span class="fu">parameter_1</span><span class="kw">:</span><span class="at"> value</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="at">  </span><span class="fu">parameter_n</span><span class="kw">:</span><span class="at"> value</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="googlesheet-source">googlesheet source<a class="anchor" aria-label="anchor" href="#googlesheet-source"></a>
</h3>
<p>Needs the <em>googlesheet4</em> R package to be installed. The googlesheet id need to be passed to <em>desc_gsheet_id</em>, and sheetname to <em>desc_gsheet_sheetname</em> arguments during initialization of <em>quetzio_server</em> object.</p>
<p>Its form is very similar to the one of the googlesheet question source. It can also be created with helper function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># assignement to hold the ID of created googlesheet</span>
<span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_desc_source.html">create_desc_source</a></span><span class="op">(</span>
  method <span class="op">=</span> <span class="st">"gsheet"</span><span class="op">)</span>

<span class="co"># see the data structure:</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span>
  <span class="fu">googlesheets4</span><span class="fu">::</span><span class="fu"><a href="https://googlesheets4.tidyverse.org/reference/range_read.html" class="external-link">read_sheet</a></span><span class="op">(</span>ss <span class="op">=</span> <span class="va">id</span>, sheet <span class="op">=</span> <span class="st">"Descriptions"</span><span class="op">)</span>
  <span class="op">)</span>
<span class="co">#&gt; tibble [1 × 6] (S3: tbl_df/tbl/data.frame)</span>
<span class="co">#&gt;  $ type   : chr "placeholder"</span>
<span class="co">#&gt;  $ align  : chr "left"</span>
<span class="co">#&gt;  $ html   : logi TRUE</span>
<span class="co">#&gt;  $ order  : logi TRUE</span>
<span class="co">#&gt;  $ inputId: chr "placeholder"</span>
<span class="co">#&gt;  $ content: chr "&lt;b&gt;Delete&lt;/b&gt; this &lt;i&gt;example&lt;/i&gt;"</span>

<span class="co"># I remove the googlesheet created for this presentation</span>
<span class="fu">googledrive</span><span class="fu">::</span><span class="fu"><a href="https://googledrive.tidyverse.org/reference/drive_trash.html" class="external-link">drive_trash</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="r-object-as-a-source">R object as a source<a class="anchor" aria-label="anchor" href="#r-object-as-a-source"></a>
</h3>
<p>Analogous to R object as the source of questions, you can provide them in the form of list or dataframe. You should then pass that object to <em>desc_object</em> argument during <em>quetzio_server</em> initialization:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># nested list don't need to be named!</span>
<span class="va">list_source</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    type <span class="op">=</span> <span class="st">"instruction_title"</span>,
    content <span class="op">=</span> <span class="st">"I am the &lt;b&gt;title&lt;/b&gt; of this &lt;i&gt;questionnaire&lt;/i&gt;"</span>,
    html <span class="op">=</span> <span class="cn">TRUE</span>,
    align <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    type <span class="op">=</span> <span class="st">"instruction_list"</span>,
    content <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"I am first"</span>, <span class="st">"I am second"</span>, <span class="st">"I am third"</span>, <span class="st">"Who am I?"</span><span class="op">)</span>,
    order <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="co"># data.frame can be configured explicitly by 'data.frame'</span>
<span class="va">df_source</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>
  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"instruction_title"</span>, <span class="st">"instruction_list"</span><span class="op">)</span>,
  content <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"I am the &lt;b&gt;title&lt;/b&gt; of this &lt;i&gt;questionnaire&lt;/i&gt;"</span>,
           <span class="st">"I am first;I am second;I am third;Who am I?"</span><span class="op">)</span>,
  html <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">NA</span><span class="op">)</span>,
  align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"center"</span>, <span class="cn">NA</span><span class="op">)</span>,
  order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">TRUE</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># You can also use the same function as for googlesheet generation to generate</span>
<span class="co"># example data.frame with placeholder row, though you need to modify it</span>
<span class="co"># afterwards</span>

<span class="va">df_source2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_desc_source.html">create_desc_source</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"df"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">df_source2</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    1 obs. of  6 variables:</span>
<span class="co">#&gt;  $ type   : chr "placeholder"</span>
<span class="co">#&gt;  $ align  : chr "left"</span>
<span class="co">#&gt;  $ html   : logi TRUE</span>
<span class="co">#&gt;  $ order  : logi TRUE</span>
<span class="co">#&gt;  $ inputId: chr "placeholder"</span>
<span class="co">#&gt;  $ content: chr "&lt;b&gt;Delete&lt;/b&gt; this &lt;i&gt;example&lt;/i&gt;"</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="additional-features">Additional features<a class="anchor" aria-label="anchor" href="#additional-features"></a>
</h2>
<p>There are even more features that are out of the scope of this vignette. For more information check other vignettes and help files.</p>
<ul>
<li>Functional features
<ul>
<li>get answers in form of data.frame with <strong>get_answers_df</strong> method</li>
<li>update item labels based on some <em>reactiveVal</em> with <strong>update_labels</strong> method</li>
<li>link multiple <strong>quetzio_server</strong> objects with <strong>quetzio_link_server</strong> object</li>
</ul>
</li>
<li>Customizable features
<ul>
<li>add your own submit button labels</li>
<li>add custom css to alternate the look of invalid input label highlight and mandatory stars</li>
<li>use specific div id to customize css styles more easily</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="alternatives-to-shiny-quetzio">Alternatives to shiny.quetzio<a class="anchor" aria-label="anchor" href="#alternatives-to-shiny-quetzio"></a>
</h2>
<p>I feel like it needs to be stated that <strong>shiny.quetzio</strong> isn’t your only option for creating questionnaires with Shiny. The main alternative is <a href="https://github.com/jdtrat/shinysurveys" target="_blank" class="external-link"><strong>shinysurveys</strong> package</a>.</p>
<p>Main difference between these are the embedding - while <strong>shiny.quetzio</strong> can be used to create questionnaire (or multiple of them) within more complex Shiny application, the <strong>shinysurverys</strong> are tailored to create whole ShinyApp by itself. It also currently (as of 0.2.0.) doesn’t offer built-in support of <strong>googlesheets4</strong>, either for source nor data collection.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Michal Kosinski, Alexander Lam, Erez Shomron, Eric Fletcher.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
